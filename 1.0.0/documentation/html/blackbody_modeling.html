<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>5. Modeling a Black Body &#8212; pwv_kpno 1.0.0 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/custom_style.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="4. Modeling the Atmosphere" href="atmospheric_modeling.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../documentation/html/index.html">
          pwv_kpno</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../documentation/html/install.html">Documentation</a></li>
                <li><a href="../../examples/html/correcting_spectra.html">Examples</a></li>
                <li><a href="../../validation/html/overview.html">Validation</a></li>
                <li><a href="https://github.com/mwvgroup/pwv_kpno/issues/new/choose">Need Help?</a></li>
                <li><a href="https://github.com/mwvgroup/pwv_kpno">Source Code</a></li>
            
            
            
            
            
          </ul>

          
                 
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">1. Installation and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="sites_and_settings.html">2. Custom Sites and Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="accessing_data.html">3. Accessing PWV Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="atmospheric_modeling.html">4. Modeling the Atmosphere</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Modeling a Black Body</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#generating-an-sed">5.1. Generating an SED</a></li>
<li class="toctree-l2"><a class="reference internal" href="#magnitude">5.2. Magnitude</a></li>
<li class="toctree-l2"><a class="reference internal" href="#estimating-zero-point-error">5.3. Estimating Zero Point Error</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="modeling-a-black-body">
<h1>5. Modeling a Black Body<a class="headerlink" href="#modeling-a-black-body" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">blackbody_with_atm</span></code> module provides functions for modeling the effects
of PWV absorption on a black body. We suggest importing this module as
<code class="docutils literal notranslate"><span class="pre">bb_atm</span></code>.</p>
<div class="section" id="generating-an-sed">
<h2>5.1. Generating an SED<a class="headerlink" href="#generating-an-sed" title="Permalink to this headline">¶</a></h2>
<p>For a given array of wavelengths in Angstroms, the <code class="docutils literal notranslate"><span class="pre">sed</span></code> function returns
the corresponding spectral energy distribution of a black body as seen through
the atmosphere.</p>
<dl class="function">
<dt id="pwv_kpno.blackbody_with_atm.sed">
<code class="descclassname">pwv_kpno.blackbody_with_atm.</code><code class="descname">sed</code><span class="sig-paren">(</span><em>temp</em>, <em>wavelengths</em>, <em>pwv</em>, <em>bins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pwv_kpno/blackbody_with_atm.html#sed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwv_kpno.blackbody_with_atm.sed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the flux of a black body under the influence of pwv absorption</p>
<p>Flux is returned in units of ergs / (angstrom * cm2 * s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>temp</strong> (<em>float</em>) – The temperature of the black body in Kelvin</li>
<li><strong>wavelengths</strong> (<em>array</em>) – The SED’s wavelengths in Angstroms</li>
<li><strong>pwv</strong> (<em>float</em>) – The PWV concentration along line of sight in mm</li>
<li><strong>bins</strong> (<em>int</em><em> or </em><em>list</em>) – Integer number of bins or sequence of bin edges
used to smooth atmospheric transmission</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An array of flux values in units of ergs / (angstrom * cm2 * s * sr)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Here we demonstrate how to find the SED of a black body between 7,000 and
10,000 Angstroms:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwv_kpno</span> <span class="kn">import</span> <span class="n">blackbody_with_atm</span> <span class="k">as</span> <span class="n">bb_atm</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bb_temp</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pwv</span> <span class="o">=</span> <span class="mi">15</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sed</span> <span class="o">=</span> <span class="n">bb_atm</span><span class="o">.</span><span class="n">sed</span><span class="p">(</span><span class="n">bb_temp</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="n">pwv</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note:</strong> If desired, the SED of a black body without atmospheric effects can
be achieved by specifying a PWV level of zero.</p>
</div>
<div class="section" id="magnitude">
<h2>5.2. Magnitude<a class="headerlink" href="#magnitude" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">magnitude</span></code> function returns the absolute magnitude of a black body in a
given band as seen under the effects of PWV absorption.</p>
<dl class="function">
<dt id="pwv_kpno.blackbody_with_atm.magnitude">
<code class="descclassname">pwv_kpno.blackbody_with_atm.</code><code class="descname">magnitude</code><span class="sig-paren">(</span><em>temp</em>, <em>band</em>, <em>pwv</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pwv_kpno/blackbody_with_atm.html#magnitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwv_kpno.blackbody_with_atm.magnitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the AB magnitude of a black body in a given band</p>
<p>Magnitudes are calculated relative to a zero point of 3631 Jy. If the band
argument is a 1d array of wavelengths, then the photometric band is treated
as a top-hat function ranging from the first value in the array to the
last. If it is two dimensional then the first dimension is treated as
wavelength values and the second as the response function for the given
band. All wavelengths values are expected in Angstroms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>temp</strong> (<em>float</em>) – The temperature of the black body in Kelvin</li>
<li><strong>band</strong> (<em>tuple</em>) – A array specifying a photometric bandpass</li>
<li><strong>pwv</strong> (<em>float</em>) – The PWV concentration along line of sight in mm</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The magnitude of the desired black body as effected by H2O absorption</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>If we want to treat the <em>i</em> band as a top hat function from 7,000 to 8,500
Angstroms, the magnitude of a black body is found by running</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwv_kpno</span> <span class="kn">import</span> <span class="n">blackbody_with_atm</span> <span class="k">as</span> <span class="n">bb_atm</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bb_temp</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i_band</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7000</span><span class="p">,</span> <span class="mi">8500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pwv</span> <span class="o">=</span> <span class="mi">15</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bb_mag</span> <span class="o">=</span> <span class="n">bb_atm</span><span class="o">.</span><span class="n">magnitude</span><span class="p">(</span><span class="n">bb_temp</span><span class="p">,</span> <span class="n">i_band</span><span class="p">,</span> <span class="n">pwv</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>We can also determine the magnitude for a real world filter by turning band
into a two dimensional array.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwv_kpno</span> <span class="kn">import</span> <span class="n">blackbody_with_atm</span> <span class="k">as</span> <span class="n">bb_atm</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bb_temp</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i_band</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">bandpass_wavelengths</span><span class="p">,</span>       <span class="c1"># Array of values in Angstroms</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">bandpass_response_function</span>  <span class="c1"># Array of transmission for each wavelength</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pwv</span> <span class="o">=</span> <span class="mi">15</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bb_mag</span> <span class="o">=</span> <span class="n">bb_atm</span><span class="o">.</span><span class="n">magnitude</span><span class="p">(</span><span class="n">bb_temp</span><span class="p">,</span> <span class="n">i_band</span><span class="p">,</span> <span class="n">pwv</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note:</strong> If desired, the absolute magnitude of a black body without
atmospheric effects can also be achieved by specifying a PWV level of zero.</p>
</div>
<div class="section" id="estimating-zero-point-error">
<h2>5.3. Estimating Zero Point Error<a class="headerlink" href="#estimating-zero-point-error" title="Permalink to this headline">¶</a></h2>
<p>Correcting photometric observations using tabulated values of a standard star
introduces residual error in the magnitudes of other stars with different
spectral types. The error in photometric zero point introduced by not
considering absorption by precipitable water vapor can be found using the
<code class="docutils literal notranslate"><span class="pre">zp_bias</span></code> function.</p>
<dl class="function">
<dt id="pwv_kpno.blackbody_with_atm.zp_bias">
<code class="descclassname">pwv_kpno.blackbody_with_atm.</code><code class="descname">zp_bias</code><span class="sig-paren">(</span><em>ref_temp</em>, <em>cal_temp</em>, <em>band</em>, <em>pwv</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pwv_kpno/blackbody_with_atm.html#zp_bias"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwv_kpno.blackbody_with_atm.zp_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the residual error in the photometric zero point due to PWV</p>
<p>Using a black body approximation, calculate the residual error in the zero
point of a photometric image cause by not considering the PWV transmission
function. Returned values are in units of magnitude relative to a zero
point of 3631 Jy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ref_temp</strong> (<em>float</em>) – The temperature of the star used to calibrate the
image in Kelvin</li>
<li><strong>cal_temp</strong> (<em>float</em>) – The temperature of another star in the same image</li>
<li><strong>band</strong> (<em>tuple</em>) – A tuple with the beginning and end wavelengths of a
photometric band in Angstroms</li>
<li><strong>pwv</strong> (<em>float</em>) – The PWV concentration along line of sight in mm</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The error in magnitudes for the photometric zero point of the given band</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The error introduced (in AB magnitudes) when calibrating a 10,000 Kelvin black
body with a 4,000 Kelvin black body is given by:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwv_kpno</span> <span class="kn">import</span> <span class="n">blackbody_with_atm</span> <span class="k">as</span> <span class="n">bb_atm</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reference_star_temp</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_star_temp</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bias</span> <span class="o">=</span> <span class="n">bb_atm</span><span class="o">.</span><span class="n">zp_bias</span><span class="p">(</span><span class="n">reference_star_temp</span><span class="p">,</span> <span class="n">other_star_temp</span><span class="p">,</span> <span class="n">i_band</span><span class="p">,</span> <span class="n">pwv</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/blackbody_modeling.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2018, Daniel J. Perrefort.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>